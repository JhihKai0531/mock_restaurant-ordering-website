import{e as g,f as O,M as C,g as T,c as n,o as l,a as t,F as h,r as w,w as j,l as N,t as d,_ as S,i as $,z as m,u as r,I as P,b as f,j as L,y as I,A as _,C as M,D,v as R,T as B}from"./index-GpWfpQeN.js";const H="/mock_restaurant-ordering-website/assets/counter-CkIRXeY4.png",E="/mock_restaurant-ordering-website/assets/credit-RtBjwCYK.png",U="/mock_restaurant-ordering-website/assets/credit-card-CNTvi83Z.png",V={class:"modal-dialog modal-dialog-centered"},A={class:"modal-content"},F={class:"modal-body text-center"},W={class:"row row-cols-2 gy-3 p-3"},Y=["id","value"],z=["for"],K=["src","alt"],X=["disabled"],Z={__name:"PaySelectModal",emits:["processPayment"],setup(k,{expose:p,emit:u}){const s=u,a=[{name:"現場付款",value:"payOnSite",imgURL:H},{name:"線上刷卡",value:"payWithCreditCard",imgURL:E},{name:"行動支付",value:"payDigital",imgURL:U}],b=g(""),o=g(null),y=g(null);O(()=>{y.value=new C(o.value),o.value.addEventListener("hide.bs.modal",()=>{b.value=""})}),T(()=>{y.value.hide()}),p({modalInstance:y});function i(){s("processPayment",b.value),y.value.hide()}return(x,c)=>(l(),n("div",{id:"paySelectModal",ref_key:"modal",ref:o,class:"modal fade",tabindex:"-1"},[t("div",V,[t("div",A,[c[1]||(c[1]=t("div",{class:"modal-header border-bottom-0"},[t("h1",{class:"modal-title fs-5 position-relative start-50 translate-middle-x"}," 請點選付款方式並確認 "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),t("div",F,[t("div",W,[(l(),n(h,null,w(a,e=>t("div",{key:e.value,class:"col"},[j(t("input",{id:e.value,"onUpdate:modelValue":c[0]||(c[0]=v=>b.value=v),type:"radio",class:"btn-check",value:e.value},null,8,Y),[[N,b.value]]),t("label",{class:"btn btn-outline-success",for:e.value},[t("p",null,d(e.name),1),t("img",{src:e.imgURL,alt:e.name,width:"50",height:"50",class:"img-fluid w-75"},null,8,K)],8,z)])),64))]),t("button",{type:"button",class:"btn btn-rosewood w-25",disabled:!b.value,onClick:i}," 確定 ",8,X)])])])],512))}},q={class:"modal-dialog modal-dialog-centered modal-sm-unresponsive"},G={class:"modal-content"},J={class:"modal-body text-center"},Q={__name:"PayLoadingModal",setup(k,{expose:p}){const u=$("paymentStatus"),s=g(null),a=g(null);O(()=>{a.value=new C(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hide.bs.modal",b),s.value.addEventListener("hidePrevented.bs.modal",o)}),T(()=>{a.value.hide()}),p({modalInstance:a});function b(){u.value!=="succeed"&&u.value!=="payOnSite"&&(u.value="")}function o(){u.value!=="processing"&&a.value.hide()}return(y,i)=>(l(),n("div",{id:"payLoadingModal",ref_key:"modal",ref:s,class:"modal fade",tabindex:"-1"},[t("div",q,[t("div",G,[t("div",J,[r(u)==="processing"?(l(),n(h,{key:0},[i[0]||(i[0]=t("h1",{class:"modal-title fs-5"},"付款處理中，請稍後",-1)),i[1]||(i[1]=t("p",{class:"mb-0 text-body-tertiary"},"不要關閉視窗",-1)),i[2]||(i[2]=t("div",{class:"loader"},null,-1))],64)):r(u)==="succeed"?(l(),n(h,{key:1},[i[3]||(i[3]=t("h1",{class:"modal-title fs-4 mb-2"},"付款成功！",-1)),i[4]||(i[4]=t("p",{class:"mb-0 text-body-tertiary"},"此為隨機模擬結果，感謝您。",-1)),i[5]||(i[5]=t("div",{class:"text-center mt-4"},[t("button",{type:"button",class:"btn btn-outline-success w-50","data-bs-dismiss":"modal"}," 關閉 ")],-1))],64)):r(u)==="failed"?(l(),n(h,{key:2},[i[6]||(i[6]=P('<h1 class="modal-title fs-4 mb-2 mt-2" data-v-07e50728>付款失敗，請再試一次。</h1><p class="mb-0 text-body-tertiary" data-v-07e50728>此為隨機模擬結果，不必擔心。</p><button type="button" class="btn-close" data-bs-dismiss="modal" data-v-07e50728></button><div class="text-center mt-4" data-v-07e50728><button type="button" class="btn btn-outline-danger w-50" data-bs-toggle="modal" data-bs-target="#paySelectModal" data-v-07e50728> 回付款選項 </button></div>',4))],64)):m("",!0)])])])],512))}},tt=S(Q,[["__scopeId","data-v-07e50728"]]),et={id:"orderHistoryAccordion",class:"accordion"},st={class:"accordion-header"},ot=["data-bs-target"],at={class:"ms-auto"},nt=["id"],lt={class:"accordion-body"},dt={class:"mb-2"},it={class:"d-inline-block col-8 align-top"},rt={class:"float-end align-top"},ct={key:0,class:"text-body-secondary ps-3"},ut={class:"table table-sm mt-2 table-bordered"},bt={key:0},mt={colspan:"2"},pt={class:"text-body-secondary"},yt={colspan:"2"},vt={key:1},_t={colspan:"3"},gt={class:"my-0 text-body-secondary text-break"},ft={class:"custom-div-cart-subtotal"},$t={class:"my-2"},ht={__name:"OrderAccordion",setup(k){const p=$("orderHistory");return(u,s)=>(l(),n("div",et,[(l(!0),n(h,null,w(r(p),(a,b)=>(l(),n("div",{key:a.dateTime,class:"accordion-item"},[t("h2",st,[t("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":`#orderHistoryContent${a.dateTime}`},[t("span",null,d(`第 ${b+1} 次點餐`),1),t("span",at,d(new Date(a.dateTime).toLocaleTimeString()),1)],8,ot)]),t("div",{id:`orderHistoryContent${a.dateTime}`,class:"accordion-collapse collapse show"},[t("div",lt,[(l(!0),n(h,null,w(a.cart,o=>(l(),n("details",{key:o.dateTime},[t("summary",dt,[t("span",it,d(o.mealObject.strMeal),1),t("span",rt,d(`NT$${o.subtotal}`),1),s[0]||(s[0]=t("br",null,null,-1)),o.setMenuObject.setMenuPrice?(l(),n("span",ct,d(o.setMenuObject.setMenuName),1)):m("",!0)]),t("table",ut,[t("tbody",null,[t("tr",null,[s[1]||(s[1]=t("td",null,"數量 / 基本單價",-1)),t("td",null,d(`×${o.count}`),1),t("td",null,d(`$${o.mealObject.price}`),1)]),t("tr",null,[t("td",null,d(o.spicyObject.name),1),s[2]||(s[2]=t("td",{colspan:"2"},"$0",-1))]),o.extraObject.value?(l(),n("tr",bt,[t("td",null,d(o.extraObject.name),1),t("td",mt,d(`$${o.extraObject.price}`),1)])):m("",!0),t("tr",null,[t("td",null,[f(d(o.setMenuObject.setMenuName),1),s[3]||(s[3]=t("br",null,null,-1)),t("span",pt,d(o.setMenuObject.setMenuDescription),1)]),t("td",yt,d(`$${o.setMenuObject.setMenuPrice}`),1)]),o.notes?(l(),n("tr",vt,[t("td",_t,[t("details",null,[s[4]||(s[4]=t("summary",null,"備註",-1)),t("p",gt,d(o.notes),1)])])])):m("",!0)])])]))),128)),t("div",ft,[s[5]||(s[5]=t("p",{class:"my-2"},"訂單小計：",-1)),t("p",$t,d(`NT$${a.cartSubtotal}`),1)])])],8,nt)]))),128))]))}},xt=S(ht,[["__scopeId","data-v-a666f75e"]]),kt={class:"container px-4 py-3"},Mt={key:0},wt={class:"text-center"},St={key:1,class:"row mb-3"},Lt={key:0,class:"col-auto"},Ot={key:1,class:"col-auto"},Ct={key:2,class:"col-auto"},Tt={key:2},jt={class:"float-end lh-sm"},Nt={class:"mb-0"},Pt={class:"mb-0"},It={__name:"OrderHistoryPage",setup(k){const p=$("guestsCount"),u=$("tableNumber"),s=$("orderHistory"),a=$("paymentStatus"),b=L(()=>new Date(s.value[0].dateTime).toLocaleDateString()),o=L(()=>{let c=0;return s.value.forEach(e=>{c+=e.cartSubtotal}),c});function y(c){c==="payOnSite"?a.value=c:c==="payWithCreditCard"||c==="payDigital"?(a.value="processing",x.value.modalInstance.show(),setTimeout(()=>{const v=Math.random()<.7?"succeed":"failed";a.value=v},5e3)):console.warn("沒有選擇有效付款選項。")}const i=g(null),x=g(null);return I(()=>{if(document.getElementById("paySelectModal").classList.contains("show")||document.getElementById("payLoadingModal").classList.contains("show"))return i.value.modalInstance.hide(),a.value!=="processing"&&x.value.modalInstance.hide(),!1}),(c,e)=>{const v=D("RouterLink");return l(),n("div",kt,[r(s).length?m("",!0):(l(),n("div",Mt,[e[3]||(e[3]=t("h1",{class:"text-center text-body-tertiary mt-4"},"尚未加入訂單",-1)),t("p",wt,[_(v,{to:"/",title:"首頁",class:"text-body-tertiary"},{default:M(()=>e[0]||(e[0]=[f(" 回菜單 ")])),_:1}),e[2]||(e[2]=f(" / ")),_(v,{to:"/cart",title:"購物車頁面",class:"text-body-tertiary"},{default:M(()=>e[1]||(e[1]=[f(" 前往購物車 ")])),_:1})])])),r(s).length?(l(),n("div",St,[e[7]||(e[7]=t("h1",{class:"col"},"點餐紀錄",-1)),r(a)==="payOnSite"||r(a)==="succeed"?m("",!0):(l(),n("div",Lt,e[4]||(e[4]=[t("button",{type:"button",class:"btn btn-outline-primary","data-bs-toggle":"modal","data-bs-target":"#paySelectModal"}," 結帳去 ",-1)]))),r(a)==="payOnSite"?(l(),n("div",Ot,e[5]||(e[5]=[t("button",{type:"button",class:"btn btn-outline-success",disabled:""},"現場結帳",-1)]))):m("",!0),r(a)==="succeed"?(l(),n("div",Ct,e[6]||(e[6]=[t("button",{type:"button",class:"btn btn-outline-success",disabled:""},"已結帳",-1)]))):m("",!0)])):m("",!0),r(s).length?(l(),n("div",Tt,[t("h5",jt,"總金額 "+d(`NT$ ${o.value} 元`),1),t("p",Nt,d(b.value),1),t("p",Pt,"桌號："+d(r(u)),1),t("p",null,[f(" 用餐人數："+d(r(p))+"位 ",1),_(v,{to:"/",class:"text-roast-brown float-end text-decoration-none"},{default:M(()=>e[8]||(e[8]=[f(" 回菜單〉 ")])),_:1})])])):m("",!0),_(Z,{ref_key:"paySelectModal",ref:i,onProcessPayment:y},null,512),_(tt,{ref_key:"payLoadingModal",ref:x},null,512),j(_(xt,null,null,512),[[R,r(s).length]]),_(B)])}}},Rt=S(It,[["__scopeId","data-v-00de5c22"]]);export{Rt as default};
