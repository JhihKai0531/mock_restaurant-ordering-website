"use strict";(self["webpackChunkrestaurant_ordering_website"]=self["webpackChunkrestaurant_ordering_website"]||[]).push([[109],{8109:function(e,l,t){t.r(l),t.d(l,{default:function(){return we}});t(4114);var a=t(6768),o=t(144),n=t(5130),s=t(4232),c=t(1387);const u={class:"card"},i={class:"list-group list-group-flush"},d={class:"row mb-2"},r={class:"col-8 fw-bolder"},v={class:"col-4 text-end"},b=["disabled","onClick"],k={class:"row"},m={class:"col-9 ps-4 text-body-secondary"},p={class:"custom-info"},f={class:"ps-3"},L={class:"col-3 text-end"},g={class:"card-footer"},y={class:"row text-body fw-semibold"},x={class:"col text-end"};function h(e,l,t,o,c,h){return(0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("ul",i,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(h.cartData,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.dateTime,class:"list-group-item"},[(0,a.Lk)("div",d,[(0,a.Lk)("div",r,[(0,a.eW)((0,s.v_)(e.mealObject.strMeal)+" ",1),l[0]||(l[0]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" "+(0,s.v_)(`×${e.count}`),1)]),(0,a.Lk)("div",v,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-rosewood","data-bs-toggle":"modal","data-bs-target":"#editModal",disabled:h.diningFinished,onClick:l=>h.emitCartItem(e)}," 編輯 ",8,b)])]),(0,a.Lk)("div",k,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[(0,a.Lk)("span",null,(0,s.v_)(e.setMenuObject.setMenuName),1),(0,a.Lk)("span",null,(0,s.v_)(e.spicyObject.name),1),(0,a.bo)((0,a.Lk)("span",null,(0,s.v_)(e.extraObject.name),513),[[n.aG,e.extraObject.name]])]),(0,a.Lk)("div",null,[(0,a.Lk)("details",null,[l[1]||(l[1]=(0,a.Lk)("summary",null,"備註",-1)),(0,a.Lk)("div",f,(0,s.v_)(e.notes||"無"),1)])])]),(0,a.Lk)("div",L,[(0,a.Lk)("b",null,(0,s.v_)(`$${e.subtotal}`),1)])])])))),128))]),(0,a.Lk)("div",g,[(0,a.Lk)("div",y,[l[3]||(l[3]=(0,a.Lk)("div",{class:"col"},"小計",-1)),(0,a.Lk)("div",x,[(0,a.RG)(e.$slots,"default",{},(()=>[l[2]||(l[2]=(0,a.eW)("未計算"))]),!0)])])])])}var _={inject:["cartData","diningFinished"],methods:{emitCartItem(e){const l=e.mealObject,t=e.dateTime,a={setMenuRadio:e.setMenuObject.setMenuId,spicy:e.spicyObject.value,extra:e.extraObject.value,notes:e.notes,count:e.count};this.$emit("editProduct",{mealItem:l,options:a,dateTime:t})}}},M=t(1241);const C=(0,M.A)(_,[["render",h],["__scopeId","data-v-8263425c"]]);var I=C,R=t(8077),w=t(5325);const E={class:"modal-dialog"},K={class:"modal-content"},T={class:"modal-body"},W={class:"row"},$={class:"col-8"},j={class:"col-4 text-end"},O=["id","value"],F=["for"],X={class:"row"},D={class:"col-8"},N={class:"col-4 text-end"},P={class:"row"},Q={class:"col"},A=["id","value"],V=["for"],B={class:"form-check"},S={class:"form-check-label d-block",for:"extraCheckbox_E"},U={class:"row"},J={class:"col-4 text-end"},G={class:"row gx-0"},H={class:"col-2 text-center"},z=["disabled"],Z={class:"col-4"},q={class:"text-end h5 mt-3"},Y=25;var ee={__name:"EditWindow",props:["cartItemPropped"],setup(e,{expose:l}){const t=(0,a.WQ)("emitter"),c=e,u=[{value:"no",name:"不辣"},{value:"mild",name:"微辣"},{value:"mildMedium",name:"小辣"},{value:"medium",name:"中辣"},{value:"hot",name:"大辣"}],i=(0,o.KR)(null),d=(0,o.KR)(null);(0,a.sV)((()=>{d.value=new R.aF(i.value,{backdrop:"static",keyboard:!1})})),(0,a.xo)((()=>{d.value.hide()})),l({modalInstance:d,clearSettings:v});const r=(0,o.KR)({setMenuRadio:"No",spicy:"no",extra:!1,notes:"",count:0});function v(){r.value={setMenuRadio:"No",spicy:"no",extra:!1,notes:"",count:0},f.value=!1}const b=(0,o.KR)({});function k(){b.value=c.cartItemPropped.mealItem}function m(){r.value=c.cartItemPropped.options}(0,a.Ic)((()=>{k(),m()}));const p=(0,a.EW)((()=>{const e=b.value.price;let l=0;l=w.find((e=>e.setMenuId===r.value.setMenuRadio)).setMenuPrice;const t=r.value.extra?25:0,a=r.value.count;return(e+l+t)*a})),f=(0,o.KR)(!1);function L(){let e=r.value.count;e++,r.value.count=e,y()}function g(){let e=r.value.count;e--,e<1&&(e=1),r.value.count=e,y()}function y(){r.value.count<1||r.value.count%1!==0?f.value=!0:f.value=!1}const x=(0,a.WQ)("cartData");function h(){if(y(),f.value)return;const e={...b.value};let l={};l={...w.find((e=>e.setMenuId===r.value.setMenuRadio))};let t={};t={...u.find((e=>e.value===r.value.spicy))};const a={value:r.value.extra,price:r.value.extra?25:0,name:r.value.extra?"加量":""},o=c.cartItemPropped.dateTime,n={mealObject:e,setMenuObject:l,spicyObject:t,extraObject:a,notes:r.value.notes,count:r.value.count,subtotal:p.value,dateTime:o};x.value.forEach(((e,l)=>{e.dateTime===n.dateTime&&x.value.splice(l,1,n)})),d.value.hide(),v()}function _(){t.emit("deleteItem",b.value),f.value=!1}function M(){const e=c.cartItemPropped.dateTime;x.value.forEach(((l,t)=>{l.dateTime===e&&x.value.splice(t,1)}))}return t.on("cancelDeleting",y),t.on("confirmDeleting",M),(0,a.hi)((()=>{t.off("cancelDeleting"),t.off("confirmDeleting")})),(e,l)=>((0,a.uX)(),(0,a.CE)("div",{id:"editModal",ref_key:"modal",ref:i,class:"modal fade",tabindex:"-1"},[(0,a.Lk)("div",E,[(0,a.Lk)("div",K,[(0,a.Lk)("div",{class:"modal-header"},[l[5]||(l[5]=(0,a.Lk)("h1",{class:"modal-title fs-5"},"編輯餐點",-1)),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal",onClick:v})]),(0,a.Lk)("form",null,[(0,a.Lk)("div",T,[(0,a.Lk)("div",W,[(0,a.Lk)("h2",$,(0,s.v_)(b.value.strMeal),1),(0,a.Lk)("div",j,(0,s.v_)(`NT$ ${b.value.price}`),1)]),(0,a.Lk)("fieldset",null,[l[6]||(l[6]=(0,a.Lk)("legend",{class:"col-form-label"},"套餐",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,o.R1)(w),(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.setMenuId,class:"form-check"},[(0,a.bo)((0,a.Lk)("input",{id:`${e.setMenuId}_E`,"onUpdate:modelValue":l[0]||(l[0]=e=>r.value.setMenuRadio=e),class:"form-check-input",type:"radio",value:e.setMenuId},null,8,O),[[n.XL,r.value.setMenuRadio]]),(0,a.Lk)("label",{class:"form-check-label d-block",for:`${e.setMenuId}_E`},[(0,a.Lk)("div",X,[(0,a.Lk)("div",D,(0,s.v_)(e.setMenuName),1),(0,a.Lk)("div",N,(0,s.v_)(`+ ${e.setMenuPrice} 元`),1)]),(0,a.Lk)("div",P,[(0,a.Lk)("div",Q,(0,s.v_)(e.setMenuDescription),1)])],8,F)])))),128))]),(0,a.Lk)("fieldset",null,[l[7]||(l[7]=(0,a.Lk)("legend",{class:"col-form-label"},"辣度",-1)),((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(u,(e=>(0,a.Lk)("div",{key:e.value,class:"form-check form-check-inline"},[(0,a.bo)((0,a.Lk)("input",{id:`${e.value}_E`,"onUpdate:modelValue":l[1]||(l[1]=e=>r.value.spicy=e),class:"form-check-input",type:"radio",value:e.value},null,8,A),[[n.XL,r.value.spicy]]),(0,a.Lk)("label",{class:"form-check-label",for:`${e.value}_E`},(0,s.v_)(e.name),9,V)]))),64))]),(0,a.Lk)("fieldset",null,[l[9]||(l[9]=(0,a.Lk)("legend",{class:"col-form-label"},"加量",-1)),(0,a.Lk)("div",B,[(0,a.bo)((0,a.Lk)("input",{id:"extraCheckbox_E","onUpdate:modelValue":l[2]||(l[2]=e=>r.value.extra=e),class:"form-check-input",type:"checkbox"},null,512),[[n.lH,r.value.extra]]),(0,a.Lk)("label",S,[(0,a.Lk)("div",U,[l[8]||(l[8]=(0,a.Lk)("div",{class:"col-8"},"是",-1)),(0,a.Lk)("div",J,(0,s.v_)(`+ ${Y} 元`),1)])])])]),(0,a.Lk)("fieldset",null,[l[10]||(l[10]=(0,a.Lk)("label",{for:"notesText_E",class:"col-form-label"},"備註",-1)),(0,a.bo)((0,a.Lk)("textarea",{id:"notesText_E","onUpdate:modelValue":l[3]||(l[3]=e=>r.value.notes=e),class:"form-control",rows:"3"},null,512),[[n.Jo,r.value.notes,void 0,{lazy:!0}]])]),(0,a.Lk)("fieldset",null,[l[14]||(l[14]=(0,a.Lk)("label",{class:"col-form-label",for:"count_E"},"數量",-1)),(0,a.Lk)("div",G,[(0,a.Lk)("div",H,[(0,a.Lk)("button",{type:"button",class:"btn border-0",disabled:r.value.count<=1,onClick:g},l[11]||(l[11]=[(0,a.Lk)("i",{class:"bi bi-dash-lg"},null,-1)]),8,z)]),(0,a.Lk)("div",Z,[(0,a.bo)((0,a.Lk)("input",(0,a.v6)({id:"count_E","onUpdate:modelValue":l[4]||(l[4]=e=>r.value.count=e),class:["form-control",{"is-invalid":f.value}],type:"number",min:"1"},(0,a.Tb)({input:y,focusout:y},!0)),null,16),[[n.Jo,r.value.count,void 0,{number:!0}]]),l[12]||(l[12]=(0,a.Lk)("div",{class:"invalid-feedback"},"請輸入正整數",-1))]),(0,a.Lk)("div",{class:"col-2 text-center"},[(0,a.Lk)("button",{type:"button",class:"btn",onClick:L},l[13]||(l[13]=[(0,a.Lk)("i",{class:"bi bi-plus-lg"},null,-1)]))])])]),(0,a.Lk)("p",q,(0,s.v_)(`小計：NT$ ${p.value} 元`),1)]),(0,a.Lk)("div",{class:"modal-footer"},[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger me-auto px-3","data-bs-target":"#deleteModel","data-bs-toggle":"modal",onClick:_}," 刪除 "),(0,a.Lk)("button",{type:"button",class:"btn btn-outline-rosewood","data-bs-dismiss":"modal",onClick:v}," 取消 "),(0,a.Lk)("button",{type:"button",class:"btn btn-rosewood",onClick:h}," 確認編輯 ")])])])])],512))}};const le=ee;var te=le;const ae={class:"modal-dialog modal-dialog-centered modal-sm-unresponsive"},oe={class:"modal-content"},ne={class:"modal-body text-center",style:{padding:"1.5rem 1.5rem 1rem"}},se={class:"mb-0 text-body-secondary"};var ce={__name:"DeleteModal",setup(e,{expose:l}){const t=(0,a.WQ)("emitter"),n=(0,o.KR)({});t.on("deleteItem",(e=>{n.value=e})),(0,a.xo)((()=>{t.off("deleteItem")}));const c=(0,o.KR)(null),u=(0,o.KR)(null);function i(){t.emit("cancelDeleting")}function d(){t.emit("confirmDeleting")}return(0,a.sV)((()=>{u.value=new R.aF(c.value)})),(0,a.xo)((()=>{u.value.hide()})),l({modalInstance:u}),(e,l)=>((0,a.uX)(),(0,a.CE)("div",{id:"deleteModel",ref_key:"modal",ref:c,class:"modal fade",tabindex:"-1"},[(0,a.Lk)("div",ae,[(0,a.Lk)("div",oe,[(0,a.Lk)("div",ne,[l[0]||(l[0]=(0,a.Lk)("h1",{class:"fs-5"},"確定要刪除此品項嗎？",-1)),(0,a.Lk)("p",se,(0,s.v_)(n.value.strMeal),1)]),(0,a.Lk)("div",{class:"modal-footer justify-content-evenly border-top-0"},[(0,a.Lk)("button",{class:"btn btn-outline-secondary","data-bs-target":"#editModal","data-bs-toggle":"modal",onClick:i}," 返回編輯 "),(0,a.Lk)("button",{class:"btn btn-danger","data-bs-dismiss":"modal",onClick:d}," 確定刪除 ")])])])],512))}};const ue=ce;var ie=ue,de=t(1371);const re={class:"container px-4 py-3"},ve={key:0,class:"mb-2"},be={class:"row mb-3 gx-0"},ke={class:"col col-lg-5"},me=["disabled"],pe={class:"row gx-0"},fe={class:"col-2 text-center col-lg-1"},Le=["disabled"],ge={class:"col-3"},ye=["disabled"],xe={class:"col-2 text-center col-lg-1"},he=["disabled"],_e={key:1},Me={class:"text-center"},Ce=["disabled"];var Ie={__name:"CartPage",setup(e){const l=(0,c.rd)(),t=(0,a.WQ)("diningFinished"),u=(0,a.WQ)("cartData"),i=(0,a.WQ)("orderHistory"),d=(0,o.KR)(!1),r=(0,o.KR)(!1);(0,a.wB)((()=>!!i.value.length),(e=>{d.value=e,r.value=e}),{immediate:!0});const v=(0,a.WQ)("guestsCount"),b=(0,a.WQ)("tableNumber");function k(){let e=v.value;e++,v.value=e,x()}function m(){let e=v.value;e--,e<1&&(e=1),v.value=e,x()}const p=(0,o.KR)(0);function f(){let e=0;u.value.forEach((l=>{e+=l.subtotal})),p.value=e}(0,a.wB)(u,f,{immediate:!0,deep:!0});const L=(0,o.KR)(!1),g=(0,o.KR)(!1);function y(){b.value?L.value=!1:L.value=!0}function x(){v.value<1||v.value%1!==0?g.value=!0:g.value=!1}const h=(0,o.KR)({});function _(e){h.value=e}function M(){if(y(),x(),L.value||g.value)return;const e={cart:u.value,cartSubtotal:p.value,tableNumber:b.value,guestsCount:v.value,dateTime:Date.now()},t=JSON.parse(JSON.stringify(e));i.value.push(t),u.value.length=0,l.push("/order-history")}const C=(0,o.KR)(null),R=(0,o.KR)(null);return(0,c.JZ)((()=>{if(document.getElementById("editModal").classList.contains("show")||document.getElementById("deleteModel").classList.contains("show"))return C.value.modalInstance.hide(),R.value.modalInstance.hide(),C.value.clearSettings(),!1})),(e,l)=>{const c=(0,a.g2)("RouterLink");return(0,a.uX)(),(0,a.CE)("div",re,[(0,o.R1)(u).length?((0,a.uX)(),(0,a.CE)("p",ve,[(0,a.bF)(c,{to:"/",class:"text-decoration-none text-roast-brown fw-semibold"},{default:(0,a.k6)((()=>l[2]||(l[2]=[(0,a.eW)("回菜單←")]))),_:1})])):(0,a.Q3)("",!0),(0,a.Lk)("form",null,[(0,a.Lk)("div",be,[l[5]||(l[5]=(0,a.Lk)("div",{class:"col"},[(0,a.Lk)("label",{for:"tableNumberSelect",class:"col-form-label"},"內用桌號")],-1)),(0,a.Lk)("div",ke,[(0,a.bo)((0,a.Lk)("select",(0,a.v6)({id:"tableNumberSelect","onUpdate:modelValue":l[0]||(l[0]=e=>(0,o.i9)(b)?b.value=e:null),class:["form-select",{"is-invalid":L.value}]},(0,a.Tb)({change:y},!0),{disabled:d.value}),l[3]||(l[3]=[(0,a.Fv)('<option value="" disabled data-v-08254c54>請選擇桌號</option><option value="A1" data-v-08254c54>A1</option><option value="A2" data-v-08254c54>A2</option><option value="A3" data-v-08254c54>A3</option><option value="B1" data-v-08254c54>B1</option><option value="B2" data-v-08254c54>B2</option>',6)]),16,me),[[n.u1,(0,o.R1)(b)]]),l[4]||(l[4]=(0,a.Lk)("div",{class:"invalid-feedback"},"請選擇您的桌號。",-1))])]),(0,a.Lk)("div",pe,[l[9]||(l[9]=(0,a.Lk)("div",{class:"col"},[(0,a.Lk)("label",{for:"guestsCountInput",class:"col-form-label"},"用餐人數")],-1)),(0,a.Lk)("div",fe,[(0,a.Lk)("button",{type:"button",title:"減少",class:"btn border-0",disabled:(0,o.R1)(v)<=1||r.value,onClick:m},l[6]||(l[6]=[(0,a.Lk)("i",{class:"bi bi-dash-lg"},null,-1)]),8,Le)]),(0,a.Lk)("div",ge,[(0,a.bo)((0,a.Lk)("input",(0,a.v6)({id:"guestsCountInput","onUpdate:modelValue":l[1]||(l[1]=e=>(0,o.i9)(v)?v.value=e:null),type:"number",min:"1",class:["form-control",{"is-invalid":g.value}]},(0,a.Tb)({input:x,focusout:x},!0),{disabled:r.value}),null,16,ye),[[n.Jo,(0,o.R1)(v),void 0,{number:!0}]]),l[7]||(l[7]=(0,a.Lk)("div",{class:"invalid-feedback"},"請輸入有效人數",-1))]),(0,a.Lk)("div",xe,[(0,a.Lk)("button",{type:"button",title:"增加",class:"btn border-0",disabled:r.value,onClick:k},l[8]||(l[8]=[(0,a.Lk)("i",{class:"bi bi-plus-lg"},null,-1)]),8,he)])])]),l[12]||(l[12]=(0,a.Lk)("hr",null,null,-1)),(0,o.R1)(u).length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",_e,[l[11]||(l[11]=(0,a.Lk)("h1",{class:"text-center text-body-tertiary mt-4"},"尚未加入餐點",-1)),(0,a.Lk)("p",Me,[(0,a.bF)(c,{to:"/",title:"首頁",class:"text-body-tertiary"},{default:(0,a.k6)((()=>l[10]||(l[10]=[(0,a.eW)("點餐去")]))),_:1})])])),(0,a.bF)(te,{ref_key:"editModal",ref:C,cartItemPropped:h.value},null,8,["cartItemPropped"]),(0,a.bF)(ie,{ref_key:"deleteModal",ref:R},null,512),(0,o.R1)(u).length?((0,a.uX)(),(0,a.Wv)(I,{key:2,onEditProduct:_},{default:(0,a.k6)((()=>[(0,a.eW)((0,s.v_)(`NT$${p.value}`),1)])),_:1})):(0,a.Q3)("",!0),(0,a.Lk)("button",{type:"button",class:"btn btn-warning fixed-bottom btn-lg btn-wine-red",disabled:(0,o.R1)(t)||!(0,o.R1)(u).length,onClick:M}," 送出訂單 ",8,Ce),(0,a.bF)(de.A)])}}};const Re=(0,M.A)(Ie,[["__scopeId","data-v-08254c54"]]);var we=Re}}]);
//# sourceMappingURL=109.587fed08.js.map