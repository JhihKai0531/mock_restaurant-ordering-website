"use strict";(self["webpackChunkrestaurant_ordering_website"]=self["webpackChunkrestaurant_ordering_website"]||[]).push([[102],{9660:function(e,t,a){a.r(t),a.d(t,{default:function(){return me}});var l=a(6768),s=a(144),n=a(4232),o=a(5130),d=a(1387),c=a(8077),u=a.p+"img/counter.48fc517b.png",i=a.p+"img/credit.5530d7fc.png",r=a.p+"img/credit-card.7760dfb8.png";const b={class:"modal-dialog modal-dialog-centered"},v={class:"modal-content"},m={class:"modal-body text-center"},k={class:"row row-cols-2 gy-3 p-3"},p=["id","value"],y=["for"],L=["src","alt"],g=["disabled"];var f={__name:"PaySelectModal",emits:["processPayment"],setup(e,{expose:t,emit:a}){const d=a,f=[{name:"現場付款",value:"payOnSite",imgURL:u},{name:"線上刷卡",value:"payWithCreditCard",imgURL:i},{name:"行動支付",value:"payDigital",imgURL:r}],_=(0,s.KR)(""),h=(0,s.KR)(null),C=(0,s.KR)(null);function x(){d("processPayment",_.value),C.value.hide()}return(0,l.sV)((()=>{C.value=new c.aF(h.value),h.value.addEventListener("hide.bs.modal",(()=>{_.value=""}))})),(0,l.xo)((()=>{C.value.hide()})),t({modalInstance:C}),(e,t)=>((0,l.uX)(),(0,l.CE)("div",{id:"paySelectModal",ref_key:"modal",ref:h,class:"modal fade",tabindex:"-1"},[(0,l.Lk)("div",b,[(0,l.Lk)("div",v,[t[1]||(t[1]=(0,l.Lk)("div",{class:"modal-header border-bottom-0"},[(0,l.Lk)("h1",{class:"modal-title fs-5 position-relative start-50 translate-middle-x"},"請點選付款方式並確認"),(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"})],-1)),(0,l.Lk)("div",m,[(0,l.Lk)("div",k,[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(f,(e=>(0,l.Lk)("div",{key:e.value,class:"col"},[(0,l.bo)((0,l.Lk)("input",{id:e.value,"onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),type:"radio",class:"btn-check",value:e.value},null,8,p),[[o.XL,_.value]]),(0,l.Lk)("label",{class:"btn btn-outline-success",for:e.value},[(0,l.Lk)("p",null,(0,n.v_)(e.name),1),(0,l.Lk)("img",{src:e.imgURL,alt:e.name,width:"50",height:"50",class:"img-fluid w-75"},null,8,L)],8,y)]))),64))]),(0,l.Lk)("button",{type:"button",class:"btn btn-rosewood w-25",disabled:!_.value,onClick:x}," 確定 ",8,g)])])])],512))}};const _=f;var h=_;const C={class:"modal-dialog modal-dialog-centered modal-sm-unresponsive"},x={class:"modal-content"},E={class:"modal-body text-center"};var R={__name:"PayLoadingModal",setup(e,{expose:t}){const a=(0,l.WQ)("paymentStatus"),n=(0,s.KR)(null),o=(0,s.KR)(null);function d(){"succeed"!==a.value&&"payOnSite"!==a.value&&(a.value="")}function u(){"processing"!==a.value&&o.value.hide()}return(0,l.sV)((()=>{o.value=new c.aF(n.value,{backdrop:"static",keyboard:!1}),n.value.addEventListener("hide.bs.modal",d),n.value.addEventListener("hidePrevented.bs.modal",u)})),(0,l.xo)((()=>{o.value.hide()})),t({modalInstance:o}),(e,t)=>((0,l.uX)(),(0,l.CE)("div",{id:"payLoadingModal",ref_key:"modal",ref:n,class:"modal fade",tabindex:"-1"},[(0,l.Lk)("div",C,[(0,l.Lk)("div",x,[(0,l.Lk)("div",E,["processing"===(0,s.R1)(a)?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[t[0]||(t[0]=(0,l.Lk)("h1",{class:"modal-title fs-5"}," 付款處理中，請稍後 ",-1)),t[1]||(t[1]=(0,l.Lk)("p",{class:"mb-0 text-body-tertiary"},"不要關閉視窗",-1)),t[2]||(t[2]=(0,l.Lk)("div",{class:"loader"},null,-1))],64)):"succeed"===(0,s.R1)(a)?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[t[3]||(t[3]=(0,l.Lk)("h1",{class:"modal-title fs-4 mb-2"}," 付款成功！ ",-1)),t[4]||(t[4]=(0,l.Lk)("p",{class:"mb-0 text-body-tertiary"},"此為隨機模擬結果，感謝您。",-1)),t[5]||(t[5]=(0,l.Lk)("div",{class:"text-center mt-4"},[(0,l.Lk)("button",{type:"button",class:"btn btn-outline-success w-50","data-bs-dismiss":"modal"}," 關閉 ")],-1))],64)):"failed"===(0,s.R1)(a)?((0,l.uX)(),(0,l.CE)(l.FK,{key:2},[t[6]||(t[6]=(0,l.Fv)('<h1 class="modal-title fs-4 mb-2 mt-2" data-v-363f4d3c> 付款失敗，請再試一次。 </h1><p class="mb-0 text-body-tertiary" data-v-363f4d3c>此為隨機模擬結果，不必擔心。</p><button type="button" class="btn-close" data-bs-dismiss="modal" data-v-363f4d3c></button><div class="text-center mt-4" data-v-363f4d3c><button type="button" class="btn btn-outline-danger w-50" data-bs-toggle="modal" data-bs-target="#paySelectModal" data-v-363f4d3c> 回付款選項 </button></div>',4))],64)):(0,l.Q3)("",!0)])])])],512))}},w=a(1241);const M=(0,w.A)(R,[["__scopeId","data-v-363f4d3c"]]);var X=M;const O={id:"orderHistoryAccordion",class:"accordion"},S={class:"accordion-header"},$=["data-bs-target"],F={class:"ms-auto"},Q=["id"],W={class:"accordion-body"},I={class:"mb-2"},K={class:"d-inline-block col-8 align-top"},j={class:"float-end align-top"},T={key:0,class:"text-body-secondary ps-3"},P={class:"table table-sm mt-2 table-bordered"},H={key:0},D={colspan:"2"},N={class:"text-body-secondary"},A={colspan:"2"},U={key:1},V={colspan:"3"},B={class:"my-0 text-body-secondary text-break"},G={class:"custom-div-cart-subtotal"},J={class:"my-2"};function Z(e,t,a,s,o,d){return(0,l.uX)(),(0,l.CE)("div",O,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(d.orderHistory,((e,a)=>((0,l.uX)(),(0,l.CE)("div",{key:e.dateTime,class:"accordion-item"},[(0,l.Lk)("h2",S,[(0,l.Lk)("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":`#orderHistoryContent${e.dateTime}`},[(0,l.Lk)("span",null,(0,n.v_)(`第 ${a+1} 次點餐`),1),(0,l.Lk)("span",F,(0,n.v_)(new Date(e.dateTime).toLocaleTimeString()),1)],8,$)]),(0,l.Lk)("div",{id:`orderHistoryContent${e.dateTime}`,class:"accordion-collapse collapse show"},[(0,l.Lk)("div",W,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.cart,(e=>((0,l.uX)(),(0,l.CE)("details",{key:e.dateTime},[(0,l.Lk)("summary",I,[(0,l.Lk)("span",K,(0,n.v_)(e.mealObject.strMeal),1),(0,l.Lk)("span",j,(0,n.v_)(`NT$${e.subtotal}`),1),t[0]||(t[0]=(0,l.Lk)("br",null,null,-1)),e.setMenuObject.setMenuPrice?((0,l.uX)(),(0,l.CE)("span",T,(0,n.v_)(e.setMenuObject.setMenuName),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("table",P,[(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[t[1]||(t[1]=(0,l.Lk)("td",null,"數量 / 基本單價",-1)),(0,l.Lk)("td",null,(0,n.v_)(`×${e.count}`),1),(0,l.Lk)("td",null,(0,n.v_)(`$${e.mealObject.price}`),1)]),(0,l.Lk)("tr",null,[(0,l.Lk)("td",null,(0,n.v_)(e.spicyObject.name),1),t[2]||(t[2]=(0,l.Lk)("td",{colspan:"2"},"$0",-1))]),e.extraObject.value?((0,l.uX)(),(0,l.CE)("tr",H,[(0,l.Lk)("td",null,(0,n.v_)(e.extraObject.name),1),(0,l.Lk)("td",D,(0,n.v_)(`$${e.extraObject.price}`),1)])):(0,l.Q3)("",!0),(0,l.Lk)("tr",null,[(0,l.Lk)("td",null,[(0,l.eW)((0,n.v_)(e.setMenuObject.setMenuName),1),t[3]||(t[3]=(0,l.Lk)("br",null,null,-1)),(0,l.Lk)("span",N,(0,n.v_)(e.setMenuObject.setMenuDescription),1)]),(0,l.Lk)("td",A,(0,n.v_)(`$${e.setMenuObject.setMenuPrice}`),1)]),e.notes?((0,l.uX)(),(0,l.CE)("tr",U,[(0,l.Lk)("td",V,[(0,l.Lk)("details",null,[t[4]||(t[4]=(0,l.Lk)("summary",null,"備註",-1)),(0,l.Lk)("p",B,(0,n.v_)(e.notes),1)])])])):(0,l.Q3)("",!0)])])])))),128)),(0,l.Lk)("div",G,[t[5]||(t[5]=(0,l.Lk)("p",{class:"my-2"},"訂單小計：",-1)),(0,l.Lk)("p",J,(0,n.v_)(`NT$${e.cartSubtotal}`),1)])])],8,Q)])))),128))])}var q={inject:["orderHistory"]};const z=(0,w.A)(q,[["render",Z],["__scopeId","data-v-a9bc4816"]]);var Y=z,ee=a(1371);const te={class:"container px-4 py-3"},ae={key:0},le={class:"text-center"},se={key:1,class:"row mb-3"},ne={key:0,class:"col-auto"},oe={key:1,class:"col-auto"},de={key:2,class:"col-auto"},ce={key:2},ue={class:"float-end lh-sm"},ie={class:"mb-0"},re={class:"mb-0"};var be={__name:"OrderHistoryPage",setup(e){const t=(0,l.WQ)("guestsCount"),a=(0,l.WQ)("tableNumber"),c=(0,l.WQ)("orderHistory"),u=(0,l.WQ)("paymentStatus"),i=(0,l.EW)((()=>new Date(c.value[0].dateTime).toLocaleDateString())),r=(0,l.EW)((()=>{let e=0;return c.value.forEach((t=>{e+=t.cartSubtotal})),e}));function b(e){"payOnSite"===e?u.value=e:"payWithCreditCard"===e||"payDigital"===e?(u.value="processing",m.value.modalInstance.show(),setTimeout((()=>{const e=Math.random(),t=e<.7?"succeed":"failed";u.value=t}),5e3)):console.warn("沒有選擇有效付款選項。")}const v=(0,s.KR)(null),m=(0,s.KR)(null);return(0,d.JZ)((()=>{if(document.getElementById("paySelectModal").classList.contains("show")||document.getElementById("payLoadingModal").classList.contains("show"))return v.value.modalInstance.hide(),"processing"!==u.value&&m.value.modalInstance.hide(),!1})),(e,d)=>{const k=(0,l.g2)("RouterLink");return(0,l.uX)(),(0,l.CE)("div",te,[(0,s.R1)(c).length?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",ae,[d[3]||(d[3]=(0,l.Lk)("h1",{class:"text-center text-body-tertiary mt-4"},"尚未加入訂單",-1)),(0,l.Lk)("p",le,[(0,l.bF)(k,{to:"/",title:"首頁",class:"text-body-tertiary"},{default:(0,l.k6)((()=>d[0]||(d[0]=[(0,l.eW)(" 回菜單 ")]))),_:1}),d[2]||(d[2]=(0,l.eW)(" / ")),(0,l.bF)(k,{to:"/cart",title:"購物車頁面",class:"text-body-tertiary"},{default:(0,l.k6)((()=>d[1]||(d[1]=[(0,l.eW)(" 前往購物車 ")]))),_:1})])])),(0,s.R1)(c).length?((0,l.uX)(),(0,l.CE)("div",se,[d[7]||(d[7]=(0,l.Lk)("h1",{class:"col"},"點餐紀錄",-1)),"payOnSite"!==(0,s.R1)(u)&&"succeed"!==(0,s.R1)(u)?((0,l.uX)(),(0,l.CE)("div",ne,d[4]||(d[4]=[(0,l.Lk)("button",{type:"button",class:"btn btn-outline-primary","data-bs-toggle":"modal","data-bs-target":"#paySelectModal"}," 結帳去 ",-1)]))):(0,l.Q3)("",!0),"payOnSite"===(0,s.R1)(u)?((0,l.uX)(),(0,l.CE)("div",oe,d[5]||(d[5]=[(0,l.Lk)("button",{type:"button",class:"btn btn-outline-success",disabled:""}," 現場結帳 ",-1)]))):(0,l.Q3)("",!0),"succeed"===(0,s.R1)(u)?((0,l.uX)(),(0,l.CE)("div",de,d[6]||(d[6]=[(0,l.Lk)("button",{type:"button",class:"btn btn-outline-success",disabled:""}," 已結帳 ",-1)]))):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0),(0,s.R1)(c).length?((0,l.uX)(),(0,l.CE)("div",ce,[(0,l.Lk)("h5",ue,"總金額 "+(0,n.v_)(`NT$ ${r.value} 元`),1),(0,l.Lk)("p",ie,(0,n.v_)(i.value),1),(0,l.Lk)("p",re,"桌號："+(0,n.v_)((0,s.R1)(a)),1),(0,l.Lk)("p",null,[(0,l.eW)(" 用餐人數："+(0,n.v_)((0,s.R1)(t))+"位 ",1),(0,l.bF)(k,{to:"/",class:"text-roast-brown float-end text-decoration-none"},{default:(0,l.k6)((()=>d[8]||(d[8]=[(0,l.eW)(" 回菜單〉 ")]))),_:1})])])):(0,l.Q3)("",!0),(0,l.bF)(h,{ref_key:"paySelectModal",ref:v,onProcessPayment:b},null,512),(0,l.bF)(X,{ref_key:"payLoadingModal",ref:m},null,512),(0,l.bo)((0,l.bF)(Y,null,null,512),[[o.aG,(0,s.R1)(c).length]]),(0,l.bF)(ee.A)])}}};const ve=(0,w.A)(be,[["__scopeId","data-v-174579fb"]]);var me=ve}}]);
//# sourceMappingURL=102.384fe4b6.js.map